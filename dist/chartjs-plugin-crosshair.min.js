/*!
 * chartjs-plugin-crosshair v1.1.6
 * https://chartjs-plugin-crosshair.netlify.com
 * (c) 2021 Chart.js Contributors
 * Released under the MIT license
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):e((t=t||self).Chart)}(this,(function(t){"use strict";(function(t){t.Interaction.modes.interpolate=function(e,a,i){for(var s=[],o=0;o<e.data.datasets.length;o++)if(e.data.datasets[o].interpolate){var r=e.getDatasetMeta(o);if(!r.hidden){var n=e.scales[r.xAxisID],l=e.scales[r.yAxisID],c=n.getValueForPixel(a.x),h=e.data.datasets[o].data,d=h.findIndex((function(t){return t.x>=c}));if(-1!==d){var x=h[d-1],g=h[d];if(x&&g)var u=(g.y-x.y)/(g.x-x.x),p=x.y+(c-x.x)*u;if(e.data.datasets[o].steppedLine&&x&&(p=x.y),!isNaN(p)){var m=l.getPixelForValue(p);if(!isNaN(m)){var v={value:p,xValue:c,tooltipPosition:function(){return this._model},hasValue:function(){return!0},_model:{x:a.x,y:m},_datasetIndex:o,_index:s.length,_xScale:{getLabelForIndex:function(t){return s[t].xValue}},_yScale:{getLabelForIndex:function(t){return s[t].value}},_chart:e};s.push(v)}}}}}var f=t.Interaction.modes.x(e,a,i);for(d=0;d<f.length;d++){var y=f[d];e.data.datasets[y._datasetIndex].interpolate||s.push(y)}return s}})(t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t),function(t){var e=t.helpers,a={line:{color:"#F66",width:1,deactivateEvents:["mouseout"],dashPattern:[]},sync:{enabled:!0,group:1,suppressTooltips:!1},zoom:{enabled:!0,zoomboxBackgroundColor:"rgba(66,133,244,0.2)",zoomboxBorderColor:"#48F",zoomButtonText:"Reset Zoom",zoomButtonClass:"reset-zoom"},snap:{enabled:!1},callbacks:{beforeZoom:function(t,e){return!0},afterZoom:function(t,e){}}},i={id:"crosshair",afterInit:function(t){if(0!=t.config.options.scales.xAxes.length){var e=t.config.options.scales.xAxes[0].type;if("linear"===e||"time"===e||"category"===e||"logarithmic"===xscaleType)void 0===t.options.plugins.crosshair&&(t.options.plugins.crosshair=a),t.crosshair={enabled:!1,x:null,originalData:[],originalXRange:{},dragStarted:!1,dragStartX:null,dragEndX:null,suppressTooltips:!1,reset:function(){this.resetZoom(t,!1,!1)}.bind(this)},this.getOption(t,"sync","enabled")&&(t.crosshair.syncEventHandler=function(e){this.handleSyncEvent(t,e)}.bind(this),t.crosshair.resetZoomEventHandler=function(e){var a=this.getOption(t,"sync","group");e.chartId!==t.id&&e.syncGroup===a&&this.resetZoom(t,!0)}.bind(this),window.addEventListener("sync-event",t.crosshair.syncEventHandler),window.addEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler)),t.panZoom=this.panZoom.bind(this,t)}},destroy:function(t){this.getOption(t,"sync","enabled")&&(window.removeEventListener("sync-event",t.crosshair.syncEventHandler),window.removeEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler))},panZoom:function(t,e){if(0!==t.crosshair.originalData.length){var a=t.crosshair.end-t.crosshair.start,i=t.crosshair.min,s=t.crosshair.max;e<0?(t.crosshair.start=Math.max(t.crosshair.start+e,i),t.crosshair.end=t.crosshair.start===i?i+a:t.crosshair.end+e):(t.crosshair.end=Math.min(t.crosshair.end+e,t.crosshair.max),t.crosshair.start=t.crosshair.end===s?s-a:t.crosshair.start+e),this.doZoom(t,t.crosshair.start,t.crosshair.end)}},getOption:function(t,i,s){return e.getValueOrDefault(t.options.plugins.crosshair[i]?t.options.plugins.crosshair[i][s]:void 0,a[i][s])},getXScale:function(t){return t.data.datasets.length?t.scales[t.getDatasetMeta(0).xAxisID]:null},getYScale:function(t){return t.scales[t.getDatasetMeta(0).yAxisID]},handleSyncEvent:function(t,e){var a=this.getOption(t,"sync","group");if(e.chartId!==t.id&&e.syncGroup===a){var i=this.getXScale(t);if(i){var s=void 0===e.original.native.buttons?e.original.native.which:e.original.native.buttons;"mouseup"===e.original.type&&(s=0);var o={type:e.original.type,chart:t,x:i.getPixelForValue(e.xValue),y:e.original.y,native:{buttons:s},stop:!0};t.controller.eventHandler(o)}}},afterEvent:function(t,e){if(0!=t.config.options.scales.xAxes.length){var a=t.config.options.scales.xAxes[0].type;if("linear"===a||"time"===a||"category"===a||"logarithmic"===xscaleType){var i=this.getXScale(t);if(i){var s=void 0===e.native.buttons?e.native.which:e.native.buttons;"mouseup"===e.native.type&&(s=0);var o=this.getOption(t,"sync","enabled"),r=this.getOption(t,"sync","group");if(!e.stop&&o){var n=new CustomEvent("sync-event");n.chartId=t.id,n.syncGroup=r,n.original=e,n.xValue=i.getValueForPixel(e.x),window.dispatchEvent(n)}var l=this.getOption(t,"sync","suppressTooltips");t.crosshair.suppressTooltips=e.stop&&l;var c=this.getOption(t,"line","deactivateEvents").every(t=>e.type!==t)&&e.x>i.getPixelForValue(i.min)&&e.x<i.getPixelForValue(i.max);if(this.getOption(t,"line","positionWhenInactive")?t.crosshair.enabled=!0:t.crosshair.enabled=c,!t.crosshair.enabled)return e.x>i.getPixelForValue(i.max)&&t.update(),!0;var h=this.getOption(t,"zoom","enabled");if(1===s&&!t.crosshair.dragStarted&&h&&(t.crosshair.dragStartX=e.x,t.crosshair.dragStarted=!0),t.crosshair.dragStarted&&0===s){t.crosshair.dragStarted=!1;var d=i.getValueForPixel(t.crosshair.dragStartX),x=i.getValueForPixel(t.crosshair.x);Math.abs(t.crosshair.dragStartX-t.crosshair.x)>1&&this.doZoom(t,d,x),t.update()}c?t.crosshair.x=e.x:"start"===this.getOption(t,"line","positionWhenInactive")?t.crosshair.x=0:"end"===this.getOption(t,"line","positionWhenInactive")&&(t.crosshair.x=t.width),t.draw()}}}},afterDraw:function(t){if(t.crosshair.enabled)return t.crosshair.dragStarted?this.drawZoombox(t):(this.getOption(t,"line","fillBehind")&&this.drawGreyedOutRect(t),this.drawTraceLine(t),this.interpolateValues(t),this.drawTracePoints(t)),!0},beforeTooltipDraw:function(t){return!t.crosshair.dragStarted&&!t.crosshair.suppressTooltips},resetZoom:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(a){for(var i=0;i<t.data.datasets.length;i++){var s=t.data.datasets[i];s.data=t.crosshair.originalData.shift(0)}var o="ticks";t.options.scales.xAxes[0].time&&(o="time"),t.crosshair.originalXRange.min?(t.options.scales.xAxes[0][o].min=t.crosshair.originalXRange.min,t.crosshair.originalXRange.min=null):delete t.options.scales.xAxes[0][o].min,t.crosshair.originalXRange.max?(t.options.scales.xAxes[0][o].max=t.crosshair.originalXRange.max,t.crosshair.originalXRange.max=null):delete t.options.scales.xAxes[0][o].max}t.crosshair.button&&t.crosshair.button.parentNode&&(t.crosshair.button.parentNode.removeChild(t.crosshair.button),t.crosshair.button=!1);var r=this.getOption(t,"sync","enabled");if(!e&&a&&r){var n=this.getOption(t,"sync","group"),l=new CustomEvent("reset-zoom-event");l.chartId=t.id,l.syncGroup=n,window.dispatchEvent(l)}if(a){var c=t.options.animation;t.options.animation=!1,t.update(),t.options.animation=c}},doZoom:function(t,i,s){if(i>s){var o=i;i=s,s=o}if(!e.getValueOrDefault(t.options.plugins.crosshair.callbacks?t.options.plugins.crosshair.callbacks.beforeZoom:void 0,a.callbacks.beforeZoom)(i,s))return!1;if("time"===t.options.scales.xAxes[0].type?(t.options.scales.xAxes[0].time.min&&0===t.crosshair.originalData.length&&(t.crosshair.originalXRange.min=t.options.scales.xAxes[0].time.min),t.options.scales.xAxes[0].time.max&&0===t.crosshair.originalData.length&&(t.crosshair.originalXRange.max=t.options.scales.xAxes[0].time.max)):(t.options.scales.xAxes[0].ticks.min&&void 0===t.crosshair.originalData.length&&(t.crosshair.originalXRange.min=t.options.scales.xAxes[0].ticks.min),t.options.scales.xAxes[0].ticks.max&&void 0===t.crosshair.originalData.length&&(t.crosshair.originalXRange.max=t.options.scales.xAxes[0].ticks.max)),!t.crosshair.button){var r=document.createElement("button"),n=this.getOption(t,"zoom","zoomButtonText"),l=this.getOption(t,"zoom","zoomButtonClass"),c=document.createTextNode(n);r.appendChild(c),r.className=l,r.addEventListener("click",function(){this.resetZoom(t)}.bind(this)),t.canvas.parentNode.appendChild(r),t.crosshair.button=r}t.options.scales.xAxes[0].time?(t.options.scales.xAxes[0].time.min=i,t.options.scales.xAxes[0].time.max=s):(t.options.scales.xAxes[0].ticks.min=i,t.options.scales.xAxes[0].ticks.max=s);for(var h=0===t.crosshair.originalData.length,d=0;d<t.data.datasets.length;d++){var x=[],g=0,u=!1,p=!1;h&&(t.crosshair.originalData[d]=t.data.datasets[d].data);for(var m=t.crosshair.originalData[d],v=0;v<m.length;v++){var f=m[v],y=this.getXScale(t).getRightValue(f);y>=i&&!u&&g>0&&(x.push(m[g-1]),u=!0),y>=i&&y<=s&&x.push(f),y>s&&!p&&g<m.length&&(x.push(f),p=!0),g+=1}t.data.datasets[d].data=x}if(t.crosshair.start=i,t.crosshair.end=s,h){var b=this.getXScale(t);t.crosshair.min=b.min,t.crosshair.max=b.max}t.update(),this.getOption(t,"callbacks","afterZoom")(i,s)},drawZoombox:function(t){var e=this.getYScale(t),a=this.getOption(t,"zoom","zoomboxBorderColor"),i=this.getOption(t,"zoom","zoomboxBackgroundColor");t.ctx.beginPath(),t.ctx.rect(t.crosshair.dragStartX,e.getPixelForValue(e.max),t.crosshair.x-t.crosshair.dragStartX,e.getPixelForValue(e.min)-e.getPixelForValue(e.max)),t.ctx.lineWidth=1,t.ctx.strokeStyle=a,t.ctx.fillStyle=i,t.ctx.fill(),t.ctx.fillStyle="",t.ctx.stroke(),t.ctx.closePath()},drawTraceLine:function(t){var e=this.getYScale(t),a=this.getOption(t,"line","width"),i=this.getOption(t,"line","color"),s=this.getOption(t,"line","dashPattern"),o=this.getOption(t,"snap","enabled"),r=this.getOption(t,"line","positionWhenInactive"),n=t.crosshair.x,l=!1===t.config.options.hover.intersect;(!r||r&&t.crosshair.enabled)&&o&&l&&t.active.length&&(n=t.active[0]._view.x),t.ctx.beginPath(),t.ctx.setLineDash(s),t.ctx.moveTo(n,e.getPixelForValue(e.max)),t.ctx.lineWidth=a,t.ctx.strokeStyle=i,t.ctx.lineTo(n,e.getPixelForValue(e.min)),t.ctx.stroke(),t.ctx.setLineDash([])},drawTracePoints:function(t){for(var e=0;e<t.data.datasets.length;e++){var a=t.data.datasets[e],i=t.getDatasetMeta(e),s=this.getOption(t,"snap","enabled"),o=this.getOption(t,"line","positionWhenInactive"),r=t.crosshair.x,n=!1===t.config.options.hover.intersect;(!o||o&&t.crosshair.enabled)&&s&&n&&t.active.length&&(r=t.active[0]._view.x);var l=t.scales[i.xAxisID],c=t.scales[i.yAxisID];if(!o&&(i.hidden||!a.interpolate))continue;const g=l.getValueForPixel(r);var h=a.data.findIndex((function(t){return t.x>=g})),d=o?l.getPixelForValue(a.data[h].x):t.crosshair.x,x=o?c.getPixelForValue(a.data[h].y):c.getPixelForValue(a.interpolatedValue);t.ctx.beginPath(),t.ctx.arc(d,x,3,0,2*Math.PI,!1),t.ctx.fillStyle="white",t.ctx.lineWidth=2,t.ctx.strokeStyle=a.borderColor,t.ctx.fill(),t.ctx.stroke()}},drawGreyedOutRect:function(t){var e=this.getYScale(t),a=t.crosshair.x;t.ctx.fillStyle=this.getOption(t,"line","fillBehind"),t.ctx.fillRect(a,0,t.width,e.getPixelForValue(e.min))},interpolateValues:function(t){for(var e=0;e<t.data.datasets.length;e++){var a=t.data.datasets[e],i=t.getDatasetMeta(e),s=t.scales[i.xAxisID].getValueForPixel(t.crosshair.x);if(!i.hidden&&a.interpolate){var o=a.data,r=o.findIndex((function(t){return t.x>=s})),n=o[r-1],l=o[r];if(t.data.datasets[e].steppedLine&&n)a.interpolatedValue=n.y;else if(n&&l){var c=(l.y-n.y)/(l.x-n.x);a.interpolatedValue=n.y+(s-n.x)*c}else a.interpolatedValue=NaN}}}};t.plugins.register(i)}(t)}));
